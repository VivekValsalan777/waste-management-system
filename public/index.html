<!DOCTYPE html>
<html>
<head><title>Report Waste</title></head>
<body>

<h2>Report Waste</h2>

<form id="reportForm" enctype="multipart/form-data">
  <input type="file" name="image" required><br><br>
  <input type="hidden" id="lat" name="latitude">
  <input type="hidden" id="lon" name="longitude">
  <button type="submit">Submit</button>
</form>

<p id="msg"></p>

<a href="track.html">Track Report</a><br>
<a href="role-select.html">Back</a>

<script>
navigator.geolocation.getCurrentPosition(
  pos => {
    lat.value = pos.coords.latitude;
    lon.value = pos.coords.longitude;
  },
  () => alert("Location permission required")
);

reportForm.onsubmit = e => {
  e.preventDefault();
  fetch("/submit-report", {
    method: "POST",
    body: new FormData(reportForm)
  })
    .then(r => r.json())
    .then(d => {
      msg.innerText = d.success
        ? "Report ID: " + d.reportId + " (Save this ID)"
        : "Submission failed";
    });
};
</script>

</body>
</html>
