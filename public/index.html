<!DOCTYPE html>
<html>
<head>
  <title>Report Waste</title>
</head>
<body>

<h2>Report Waste</h2>

<form id="reportForm" enctype="multipart/form-data">
  <input type="file" name="image" required><br><br>

  <input type="hidden" id="lat" name="latitude">
  <input type="hidden" id="lon" name="longitude">

  <button type="submit">Submit Report</button>
</form>

<p id="msg"></p>

<a href="track.html">Track Report</a>
<br>
<a href="role-select.html">Back to Role Selection</a>

<script>
navigator.geolocation.getCurrentPosition(
  pos => {
    lat.value = pos.coords.latitude;
    lon.value = pos.coords.longitude;
  },
  () => alert("Location permission required")
);

reportForm.onsubmit = e => {
  e.preventDefault();

  const data = new FormData(reportForm);

  fetch("/submit-report", { method: "POST", body: data })
    .then(r => r.json())
    .then(d => {
      if (d.success) {
        msg.innerText = "Report submitted. ID: " + d.reportId;
        reportForm.reset();
      } else {
        msg.innerText = "Submission failed.";
      }
    });
};
</script>

</body>
</html>
